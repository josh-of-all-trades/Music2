<!DOCTYPE HTML>
<html>
<head>
	Awesome App
</head>

<body bgcolor = "black">


	<style type="text/css">
		#container { position:absolute; left: 17%; top:50%; height:13em; width: 710px; margin-top:-5em ; background-color: gray; padding: 25px}
		#buttons {padding-bottom: 10px}
	</style>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

	<div id="container">
		<div id="buttons">
	  		<button type="button" id="start" class="buttons" style="height: 55px; width: 55px">
		    	<img src="img/start.png" style=" height: 40px ; width: 40 px">
			</button>
	    	<button type="button" id="stop" style="height: 55px; width: 55px">
		    	<img src="img/stop.png" style="height: 40px ; width: 40 px">
			</button>
		</div>


	<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.1-beta2.js"></script>
	<script>
		// 

		// creates a 4 x 6 array for previous user data
		var prevBoxes = new Array(4);
		for (var i = 0; i < 4; i++) {
			prevBoxes[i] = new Array(6);
		}

        // creates a 32 x 6 array
	  	var boxes = new Array(32);
	  	for (var i = 0; i < 32; i++) {
	   		boxes[i] = new Array(6);
	  	}
		
		// Creates a stage
		var stage = new Kinetic.Stage({
			container: 'container',
			align: 'center',
			width: 900,
			height: 200
		});

        var layer1 = new Kinetic.Layer();
        var layer2 = new Kinetic.Layer();
        var timeLineLayer = new Kinetic.Layer();

        // displays the array of objects containing previous user's last bar
        for (var i = 0; i < 4; i++) {
        	for (var j = 0; j < 6; j++) {

        		// request last bar from port
        		if (true) {
	        		prevBoxes[i][j] = new Kinetic.Rect({
	        			x: i * 35,
	        			y: j * 25,
	        			width: 35,
	        			height: 25,
	        			fill: 'blue',
	        			stroke:'gray',
	        			strokeWidth:3,
	        			id: i.toString() + j.toString()
	        		});
        		}
        		layer1.add(prevBoxes[i][j]);
        	}
        }

	  	// Creates an array of objects containing a boolean and kinetic rectangles
		for(var i = 4; i < 20; i++) {
			for (var j = 0; j < 6; j++) {
				boxes[i][j] = {
					isOn : false,
					box : new Kinetic.Rect({
						x: /*Math.floor((i)/ 4) * 7 + */(i * 35),
						y: j * 25,
						width: 35,
						height: 25,
						fill: 'black',
						strokeWidth: 3,
						stroke: 'gray',
						id: i.toString() + j.toString()
					})
				}
				boxes[i][j].box.on('click', function() {
					if (this.isOn) {
						this.isOn = false;
						this.setFill('black');
					} else {
						this.isOn = true;
				        this.setFill('red');
					}
	   	    		layer2.draw();
	   		   	});

				boxes[i][j].box.on('mouseover', function() {
//					if (this.isOn) {
						this.setFill('#993333');
//					} else {
//				        this.setFill('#999999');
//					}
	   	    		layer2.draw();
	   		   	});

				boxes[i][j].box.on('mouseout', function() {
					if (this.isOn) {
						this.setFill('red');
					} else {
				        this.setFill('black');
					}
	   	    		layer2.draw();
	   		   	});


				layer2.add(boxes[i][j].box);
			}
		}

		var timeLine = new Kinetic.Rect({
			x: 0,
			y: 0,
			width: 6,
			height: 150,
			fill: 'yellow',
			id: "time_line"
		});


		timeLineLayer.add(timeLine);
		stage.add(layer1);
		stage.add(layer2);
		stage.add(timeLineLayer);
/*
      	setTimeout(function() {
        	timeLine.transitionTo({
          	x: 720,
          	duration: 3,
	        });
    	}, 1000);
*/

      	var trans = null;

    	document.getElementById('start').addEventListener('click', function() {
	        timeLine.setAttrs({
	          x: 0
	        });

  		    trans = timeLine.transitionTo({
    	      x: 700,
	          duration: 5
        	});
	    }, false);

	    document.getElementById('stop').addEventListener('click', function() {
        	if(trans) {
          	trans.stop();
 	       }
      	}, false);
/*
      	var touching = function(x1, x2) {
			return ((x1+3) > x2 && (x1+3) < x2 + 35);
			//alert('hello');
		};

		var checkCollision = function() {
	    	for (var j = 0; j < 5; j++) {
/*					if (touching(timeLine.x, prevBoxes[i][j].box.x)) {
			        	prevBoxes[i][j].box.setFill('green');		        	
					}*//*
				var xPos = timeLine.x;
				if (boxes[Math.floor(xPos)]) {
					alert('hello');
			       	boxes[i][j].box.setFill('green');
				}
			}
			
		}
	        		

		window.setInterval(checkCollision(), 5);
*/

/*
		var touching = function(x1, x2) {
			return ((x1+3) > x2 && (x1+3) < x2 + 35);
		};

		for (var i = 0; i < 4; i++) {
        	for (var j = 0; j < 5; j++) {
				if (touching(trans.x, prevBoxes[i][j].box.x) {
		        	prevBoxes[i][j].box.setFill('green');		        	
				}
			}
		}
	        	
*/


	</script>

</body>
</html>